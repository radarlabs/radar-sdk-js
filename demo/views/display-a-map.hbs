<div class="content flex-grow-1 p-4">
  <h1 class="mb-4">Display a map</h1>
  <div id="error-alert" class="alert alert-danger fade show" role="alert" style="display: none;">
    <strong>Error</strong> Something went wrong. Check the developer console for details.
  </div>

  <p>Initialize a new map with the Radar SDK and render on the page.</p>

  <div class="callout">
    Radar map objects are MapLibre GL JS references.
    See their <a href="https://maplibre.org/maplibre-gl-js-docs/api/">documentation</a> for additional functionality.
  </div>

  <div>
    <div id="map" style="width: 100%; height: 500px; display: none;"></div>
    <div id="map-warning" style="width: 100%; height: 500px; background: #f7fafc;">
      <p style="color: #697386; font-weight: bold; text-align: center; padding-top: 220px;">Add publishable key to see map</p>
    </div>
  </div>

  <div class="mt-4">
    <pre><code class="code-sample language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset="utf-8" /&gt;
    &lt;meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" /&gt;
    &lt;link href="https://js.radar.com/{{sdk_version}}/radar.css" rel="stylesheet"&gt;
    &lt;script src="https://js.radar.com/{{sdk_version}}/radar.min.js"&gt;&lt;/script&gt;
  &lt;/head&gt;

  &lt;body&gt;
    &lt;div id="map" style="width: 100%; height: 500px;" /&gt;

    &lt;script type="text/javascript"&gt;
      Radar.initialize('&lt;RADAR_PUBLISHABLE_KEY&gt;');

      const map = Radar.ui.map({
        container: 'map',
      });
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code>
    </pre>
  </div>
</div>

<script>
  let map;
  const initialize = (publishableKey) => {
    $('#error-alert').hide();
    $('#map-warning').hide();
    $('#map').show();

    Radar.initialize(publishableKey, { debug: true });

    // prevent duplicate maps from rendering over each other
    if (map) {
      map.remove();
    }

    map = Radar.ui.map({
      container: 'map',
    });

    map.on('error', (err) => {
      console.error(err);
      $('#error-alert').show();
    });
  };


  // initalize map on api key changes
  $('#publishableKey').on('change', () => {
    const publishableKey = $('#publishableKey').val();
    if (publishableKey) {
      initialize(publishableKey);
    }
  });
</script>
